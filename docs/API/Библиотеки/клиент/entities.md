# Система управления сущностями

Модуль `api.entities` обеспечивает управление сущностями (мобами) на сервере, включая регистрацию, синхронизацию данных и обработку событий спавна/деспавна.

>[!WARNING]
> Перед чтением документации к клиентской части **api.entities**, рекомендуется прочитать серверную часть


## Указание обработчика
```lua
api.entities.set_handler(
    entities_tbl: table<entity_name>,
    handler: function(
            uid: number, 
            def: number, 
            dirty: table<custom_field>
        )
    )
```
- entities_tbl (table) - Таблица с перечислением строковых айдишников сущностей
- handler (function) - Обработчик изменения полей сущности
    - uid - User-ID сущности
    - def - Числовой индекс сущности
    - dirty - Таблица с изменёнными кастомными полями сущности

    handler нужен для того, чтобы мод мог применить изменения полей с сервера на клиенте

## Добавление/Удаление десинхронных сущностей
```lua
api.entities.desync(name: String)
```
Принимает строковый айди сущности и делает её десинхронной.

Десинхронные сущности - сущности, которые видны только клиенту. Их можно заспавнить через entities.spawn на клиенте и при этом они не будут отслеживаться стандартными методами ядра

```lua
api.entities.sync(name: String)
```
Принимает строковый айди сущности и делает её синхронной.

Синхронные сущности нельзя заспавнить через entities.spawn на клиенте и они будут отслеживаться стандартными методами ядра